# Webhook Worker Environment Configuration
# Copy to /etc/webhook-worker/webhook-worker.env and customize

# ============================================================================
# Database Configuration
# ============================================================================
DATABASE_URL=postgresql://postgres:password@localhost:5432/epic_voice_db

# ============================================================================
# Worker Configuration
# ============================================================================
# Poll interval (seconds) - how often to check queue when empty
WORKER_POLL_INTERVAL=5

# Batch size - how many webhooks to process per poll
WORKER_BATCH_SIZE=10

# Worker timeout (seconds) - maximum time for HTTP request
WORKER_TIMEOUT=30

# ============================================================================
# Retry Configuration
# ============================================================================
# Base delay for exponential backoff (seconds)
RETRY_BASE_DELAY=30

# Maximum delay between retries (seconds)
RETRY_MAX_DELAY=3600

# Maximum delivery attempts before dead letter
RETRY_MAX_ATTEMPTS=5

# ============================================================================
# HTTP Configuration
# ============================================================================
# HTTP request timeout (seconds)
HTTP_TIMEOUT=30

# HTTP connection pool size
HTTP_POOL_SIZE=10

# HTTP max retries for network errors
HTTP_MAX_RETRIES=3

# ============================================================================
# Logging Configuration
# ============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file path (optional, systemd journal is primary)
LOG_FILE=/opt/livekit1/logs/webhook-worker.log

# Log format
LOG_FORMAT=%(asctime)s [%(levelname)s] [Worker-%(worker_id)s] %(message)s

# ============================================================================
# Metrics Configuration (Optional)
# ============================================================================
# Enable Prometheus metrics endpoint
METRICS_ENABLED=true

# Metrics HTTP server port
METRICS_PORT=9090

# Metrics path
METRICS_PATH=/metrics

# ============================================================================
# Security Configuration
# ============================================================================
# Encryption key for webhook secrets (base64 encoded)
# Generate with: python3 -c "import base64; import os; print(base64.b64encode(os.urandom(32)).decode())"
WEBHOOK_SECRET_ENCRYPTION_KEY=REPLACE_WITH_GENERATED_KEY

# ============================================================================
# Feature Flags
# ============================================================================
# Enable webhook delivery audit log
AUDIT_LOG_ENABLED=true

# Enable dead letter queue notifications
DEAD_LETTER_NOTIFICATIONS=true

# ============================================================================
# Performance Tuning
# ============================================================================
# Database connection pool size
DB_POOL_SIZE=10

# Database connection pool timeout (seconds)
DB_POOL_TIMEOUT=30

# Maximum concurrent webhook deliveries per worker
MAX_CONCURRENT_DELIVERIES=10
